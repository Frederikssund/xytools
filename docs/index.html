<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.7: http://docutils.sourceforge.net/" />
<title>XY Tools plugin (version 0.2)</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 6253 2010-03-02 00:24:53Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: left }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="xy-tools-plugin-version-0-2">
<h1 class="title">XY Tools plugin (version 0.2)</h1>

<div class="section" id="aim">
<h1>Aim</h1>
<p>The idea of the xy-tools-plugin is to group some functionality needed when you often work with tables with x and y columns (eg Excel files, dbf files or even txt/csv files).</p>
<p>The plugin has the following functions:</p>
<ol class="arabic simple">
<li>fill an x- and y-column of a given attribute table by clicking on a (reference) map.</li>
<li>after 'filling the x and y column' you are able to export the table to a point shape file by using the x- and y-column as coordinates for the Point geometries</li>
<li>open Excel files, either as a Memory-layer with geometries on 0,0 or using coordinates from an x and y column</li>
<li>save the attribute table of a layer as an Excel file</li>
</ol>
<p>It started off as a plugin for a user who had an excell file with
toponiemen / fieldnames and a stack of old scanned cadastral maps.</p>
</div>
<div class="section" id="use">
<h1>Use</h1>
<p>If you have installed the xytools plugins, you should see a new button in the edit/digitize toolbar (see red circle in image):</p>
<img alt="img/xytoolbutton.png" src="img/xytoolbutton.png" />
<p>and a context menu in the plugin menu:</p>
<img alt="img/save.png" src="img/save.png" />
<div class="section" id="filling-an-x-and-y-column-of-a-dbf-file">
<h2>Filling an x and y column of a dbf file</h2>
<p>Open the dbf file by opening it as a normal 'vector' layer.</p>
<p>Start by 'toggle edit' of a given layer (1).</p>
<p>When the layer is a vector layer, the xytool-button will be activated (2).</p>
<p>When checked a dialog pops up (3) where you will have to choose the
x and y columns.</p>
<p>Before clicking in the map: open the attribute table and make one feature/record active (4).</p>
<img alt="img/activate.png" src="img/activate.png" />
<p>You can now click in the map to fill the designated x and y fields of the selected record.</p>
<p>When selecting a record in the attribute table a red cross is shown on those x,y coordinates</p>
<p>The tool behaves as a normal digitize tool. By toggling editing again you will be asked to either
save your edits, or discard them.</p>
<img alt="img/click.png" src="img/click.png" />
</div>
<div class="section" id="saving-the-attribute-table-as-a-shape-file">
<h2>Saving the attribute table as a shape file</h2>
<p>In the menu of xy tools there is the possibility to save a attribute table as a point shape file (img below).</p>
<p>Geometries of the shape file will be using the x- and y- columns for there coordinates.</p>
<img alt="img/save.png" src="img/save.png" />
</div>
<div class="section" id="opening-an-excel-file-as-a-vector-layer">
<h2>Opening an Excel file as a Vector layer</h2>
<p><em>(to use this functionality you should have the xlrd library installed. On Windows you can get it via osgeo4w. For Linux you can probably install it via your package manager. Or you can get it from the project page: http://www.python-excel.org/ )</em></p>
<p>Op open an Excel file and use it either as a attribute table OR as a point vector layer, choose 'Open Excel file as attribute tabl or Point layer' from the xytools plugin menu options:</p>
<img alt="img/save.png" src="img/save.png" />
<p>You will be given the option to choose an x- and y-column from the excel file. The values of those columns will be used as x and y coordinate for the Point features of the Memory layer.</p>
<p>You can also CANCEL the xy-column dialog, then the rows will also be read as features, BUT the geometries will all have zero's as x and y</p>
<p>There are some things to consider for this:</p>
<ul class="simple">
<li>the excel file is read into a 'Memory layer'. That is it is volatile: <strong>edits in this layer will NOT be saved into the excel file</strong>  AND quiting QGIS will discard the layer. If you want to save the layer, use the normal QGIS menu options to save the memory layer to something else like a shapefile, a spatialite file or an KML-file.</li>
<li>the first row of the excel file will be read as attribute names/keys. So if you have data without a column header, please add one before opening it in qgis with the xytool plugin</li>
<li>when there is a non numeric value in one of the cells of the excel table, the proces is stopped and the layer is discarded</li>
<li>opening of newer Excel (xlsx) files is not supported by the python lib used for handling excel files. Use LibreOffice, OpenOffice or Excel to open the file and save it as a xls file first.</li>
</ul>
</div>
<div class="section" id="saving-the-attribute-table-of-a-vector-layer-as-an-excel-file">
<h2>Saving the attribute table of a vector layer as an Excel file</h2>
<p><em>(to use this functionality you should have the xlw library installed. On Windows you can get it via osgeo4w. For Linux you can probably install it via your package manager. Or you can get it from the project page: http://www.python-excel.org/ )</em></p>
<p>When you have a vector layer active, choose 'Save attribute table as Excel file' from the xytools plugin menu options:</p>
<img alt="img/save.png" src="img/save.png" />
<p>It will ask you where to save the file and do a simple save. That is: use the attribute key's in the first row and all values of a geometry as a row (as strings).</p>
</div>
</div>
<div class="section" id="notes-and-versions">
<h1>Notes and versions</h1>
<p>Currently the plugin is working both with shape files and single dbf-files. Saving csv files is not supported by
the underlying OGR-library.</p>
<p>So: for a dbf you can add and remove records. But if you want further editing: like inserting records, adding columns etc,
either use Libre/Open-office, or one of the other qgis table plugins.</p>
<ul class="simple">
<li>0.2.0 open Excel files either as attribute table, or as point shape file (python xlrd lib needed).  Ability to save current attributetable as an Excel file (python xlwt lib needed). Attiion of plugin metadata to plugin.</li>
<li>0.1.2 coordinates as floats instead of ints, Makefile and dist changes</li>
<li>0.1.1 first public version in git</li>
</ul>
</div>
<div class="section" id="ideas-todo">
<h1>Ideas/todo</h1>
<ul class="simple">
<li>maybe some kind of dialog for the plugin?</li>
<li>after clicking an xy, move selected record in attribute table to next row (and stop doing this if the click is a right click)</li>
<li>instead of saving as shape: make it a memory layer, giving it the possibility to use the generic 'save as'-whatever dialog.</li>
<li>reproject / change srs of a table containing x and y colum</li>
<li>selecting a record of a single dbf raises errors in command box</li>
</ul>
</div>
<div class="section" id="and">
<h1>And</h1>
<p>If you find bugs or have ideas for this plugin, contact Richard Duivenvoorde ( <a class="reference external" href="mailto:richard&#64;duif.net">richard&#64;duif.net</a> ).</p>
</div>
</div>
</body>
</html>
